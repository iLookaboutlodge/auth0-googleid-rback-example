{"ast":null,"code":"import _objectSpread from \"/Users/bernardlin/rbac-tutorial-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/bernardlin/rbac-tutorial-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/bernardlin/rbac-tutorial-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/bernardlin/rbac-tutorial-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/bernardlin/rbac-tutorial-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/bernardlin/rbac-tutorial-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/bernardlin/rbac-tutorial-app/src/components/Auth.js\";\nimport React, { Component } from \"react\";\nimport auth0 from \"auth0-js\";\nimport { AUTH_CONFIG } from \"../constants/auth0-variables\";\nimport { AuthProvider } from \"../authContext\";\nvar auth = new auth0.WebAuth({\n  domain: AUTH_CONFIG.domain,\n  clientID: AUTH_CONFIG.clientId,\n  redirectUri: AUTH_CONFIG.callbackUrl,\n  audience: \"https://\".concat(AUTH_CONFIG.domain, \"/userinfo\"),\n  responseType: \"token id_token\"\n});\n\nvar Auth =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Auth, _Component);\n\n  function Auth() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Auth);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Auth)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      authenticated: false,\n      user: {\n        role: \"visitor\"\n      },\n      accessToken: \"\"\n    };\n\n    _this.initiateLogin = function () {\n      auth.authorize();\n    };\n\n    _this.logout = function () {\n      _this.setState({\n        authenticated: false,\n        user: {\n          role: \"visitor\"\n        },\n        accessToken: \"\"\n      });\n    };\n\n    _this.handleAuthentication = function () {\n      auth.parseHash(function (error, authResult) {\n        if (error) {\n          console.log(error);\n          console.log(\"Error \".concat(error.error, \" Occured\"));\n          return;\n        }\n\n        _this.setSession(authResult.idTokenPayload);\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Auth, [{\n    key: \"setSession\",\n    value: function setSession(data) {\n      var user = {\n        id: data.sub,\n        email: data.email,\n        role: data[AUTH_CONFIG.roleUrl]\n      };\n      this.setState({\n        authenticated: true,\n        accessToken: data.accessToken,\n        user: user\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var authProviderValue = _objectSpread({}, this.state, {\n        initiateLogin: this.initiateLogin,\n        handleAuthentication: this.handleAuthentication,\n        logout: this.logout\n      });\n\n      return React.createElement(AuthProvider, {\n        value: authProviderValue,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, this.props.children);\n    }\n  }]);\n\n  return Auth;\n}(Component);\n\nexport default Auth;","map":{"version":3,"sources":["/Users/bernardlin/rbac-tutorial-app/src/components/Auth.js"],"names":["React","Component","auth0","AUTH_CONFIG","AuthProvider","auth","WebAuth","domain","clientID","clientId","redirectUri","callbackUrl","audience","responseType","Auth","state","authenticated","user","role","accessToken","initiateLogin","authorize","logout","setState","handleAuthentication","parseHash","error","authResult","console","log","setSession","idTokenPayload","data","id","sub","email","roleUrl","authProviderValue","props","children"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,KAAP,MAAkB,UAAlB;AAEA,SAASC,WAAT,QAA4B,8BAA5B;AACA,SAASC,YAAT,QAA6B,gBAA7B;AAEA,IAAMC,IAAI,GAAG,IAAIH,KAAK,CAACI,OAAV,CAAkB;AAC7BC,EAAAA,MAAM,EAAEJ,WAAW,CAACI,MADS;AAE7BC,EAAAA,QAAQ,EAAEL,WAAW,CAACM,QAFO;AAG7BC,EAAAA,WAAW,EAAEP,WAAW,CAACQ,WAHI;AAI7BC,EAAAA,QAAQ,oBAAaT,WAAW,CAACI,MAAzB,cAJqB;AAK7BM,EAAAA,YAAY,EAAE;AALe,CAAlB,CAAb;;IAQMC,I;;;;;;;;;;;;;;;;;UACJC,K,GAAQ;AACNC,MAAAA,aAAa,EAAE,KADT;AAENC,MAAAA,IAAI,EAAE;AACJC,QAAAA,IAAI,EAAE;AADF,OAFA;AAKNC,MAAAA,WAAW,EAAE;AALP,K;;UAQRC,a,GAAgB,YAAM;AACpBf,MAAAA,IAAI,CAACgB,SAAL;AACD,K;;UAEDC,M,GAAS,YAAM;AACb,YAAKC,QAAL,CAAc;AACZP,QAAAA,aAAa,EAAE,KADH;AAEZC,QAAAA,IAAI,EAAE;AACJC,UAAAA,IAAI,EAAE;AADF,SAFM;AAKZC,QAAAA,WAAW,EAAE;AALD,OAAd;AAOD,K;;UAEDK,oB,GAAuB,YAAM;AAC3BnB,MAAAA,IAAI,CAACoB,SAAL,CAAe,UAACC,KAAD,EAAQC,UAAR,EAAuB;AACpC,YAAID,KAAJ,EAAW;AACTE,UAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ;AACAE,UAAAA,OAAO,CAACC,GAAR,iBAAqBH,KAAK,CAACA,KAA3B;AACA;AACD;;AAED,cAAKI,UAAL,CAAgBH,UAAU,CAACI,cAA3B;AACD,OARD;AASD,K;;;;;;;+BAEUC,I,EAAM;AACf,UAAMf,IAAI,GAAG;AACXgB,QAAAA,EAAE,EAAED,IAAI,CAACE,GADE;AAEXC,QAAAA,KAAK,EAAEH,IAAI,CAACG,KAFD;AAGXjB,QAAAA,IAAI,EAAEc,IAAI,CAAC7B,WAAW,CAACiC,OAAb;AAHC,OAAb;AAKA,WAAKb,QAAL,CAAc;AACZP,QAAAA,aAAa,EAAE,IADH;AAEZG,QAAAA,WAAW,EAAEa,IAAI,CAACb,WAFN;AAGZF,QAAAA,IAAI,EAAJA;AAHY,OAAd;AAKD;;;6BAEQ;AACP,UAAMoB,iBAAiB,qBAClB,KAAKtB,KADa;AAErBK,QAAAA,aAAa,EAAE,KAAKA,aAFC;AAGrBI,QAAAA,oBAAoB,EAAE,KAAKA,oBAHN;AAIrBF,QAAAA,MAAM,EAAE,KAAKA;AAJQ,QAAvB;;AAMA,aACE,oBAAC,YAAD;AAAc,QAAA,KAAK,EAAEe,iBAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKC,KAAL,CAAWC,QADd,CADF;AAKD;;;;EA5DgBtC,S;;AA+DnB,eAAea,IAAf","sourcesContent":["import React, { Component } from \"react\";\nimport auth0 from \"auth0-js\";\n\nimport { AUTH_CONFIG } from \"../constants/auth0-variables\";\nimport { AuthProvider } from \"../authContext\";\n\nconst auth = new auth0.WebAuth({\n  domain: AUTH_CONFIG.domain,\n  clientID: AUTH_CONFIG.clientId,\n  redirectUri: AUTH_CONFIG.callbackUrl,\n  audience: `https://${AUTH_CONFIG.domain}/userinfo`,\n  responseType: \"token id_token\"\n});\n\nclass Auth extends Component {\n  state = {\n    authenticated: false,\n    user: {\n      role: \"visitor\"\n    },\n    accessToken: \"\"\n  };\n\n  initiateLogin = () => {\n    auth.authorize();\n  };\n\n  logout = () => {\n    this.setState({\n      authenticated: false,\n      user: {\n        role: \"visitor\"\n      },\n      accessToken: \"\"\n    });\n  };\n\n  handleAuthentication = () => {\n    auth.parseHash((error, authResult) => {\n      if (error) {\n        console.log(error);\n        console.log(`Error ${error.error} Occured`);\n        return;\n      }\n\n      this.setSession(authResult.idTokenPayload);\n    });\n  };\n\n  setSession(data) {\n    const user = {\n      id: data.sub,\n      email: data.email,\n      role: data[AUTH_CONFIG.roleUrl]\n    };\n    this.setState({\n      authenticated: true,\n      accessToken: data.accessToken,\n      user\n    });\n  }\n\n  render() {\n    const authProviderValue = {\n      ...this.state,\n      initiateLogin: this.initiateLogin,\n      handleAuthentication: this.handleAuthentication,\n      logout: this.logout\n    };\n    return (\n      <AuthProvider value={authProviderValue}>\n        {this.props.children}\n      </AuthProvider>\n    );\n  }\n}\n\nexport default Auth;\n"]},"metadata":{},"sourceType":"module"}